<!doctype html>
<html>
    <head>
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,500|Roboto+Mono|Roboto+Condensed:400,700&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <link rel="stylesheet" href="https://code.getmdl.io/1.2.0/material.teal-red.min.css" />
    </head>

    <body>
        <div id="elm-area"></div>

        <script src="elm.js"></script>
        <script>
            const app = Elm.Main.fullscreen();
            // https://elmlang.slack.com/archives/C192T0Q1E/p1497303588289542
            //const audioContext = new AudioContext();

            app.ports.port_playFreqs.subscribe(function (freqs) {
                const audioContext = new AudioContext();
                const interval = 0.5;
                const gap = 0.2;
                let startTime = 0;

                freqs.forEach((freq) => {
                    const oscillator = audioContext.createOscillator();

                    oscillator.connect(audioContext.destination);
                    oscillator.frequency.value = freq;

                    console.log ("startTime, freq",startTime, freq);
                    oscillator.start(startTime);
                    startTime += interval;
                    let stoptime = startTime - gap;
                    oscillator.stop(stoptime);
                });
            });
        </script>
    </body>
</html>